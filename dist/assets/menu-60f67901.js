import{o as g,u as B,A as R,t as T,N as F,a as m}from"./keyboard-16767ccf.js";import{w as j}from"./use-outside-click-10b1ef55.js";import{s as K}from"./use-resolve-button-type-fb66ebe2.js";import{A as S,H as N,z as P,q as M,D as U,E as _,I as q,i as H,J as x}from"./index-bfbdc443.js";import{i as V,w as W,h as J,_ as O,O as Q,v as Y,N as k}from"./focus-management-2ab41560.js";import{t as z,i as D,l as X}from"./open-closed-84e398ab.js";function E(t){return[t.screenX,t.screenY]}function Z(){let t=S([-1,-1]);return{wasMoved(r){let l=E(r);return t.value[0]===l[0]&&t.value[1]===l[1]?!1:(t.value=l,!0)},update(r){t.value=E(r)}}}function G({container:t,accept:r,walk:l,enabled:o}){N(()=>{let e=t.value;if(!e||o!==void 0&&!o.value)return;let a=V(t);if(!a)return;let i=Object.assign(f=>r(f),{acceptNode:r}),p=a.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,i,!1);for(;p.nextNode();)l(p.currentNode)})}function ee(t){throw new Error("Unexpected object: "+t)}var h=(t=>(t[t.First=0]="First",t[t.Previous=1]="Previous",t[t.Next=2]="Next",t[t.Last=3]="Last",t[t.Specific=4]="Specific",t[t.Nothing=5]="Nothing",t))(h||{});function te(t,r){let l=r.resolveItems();if(l.length<=0)return null;let o=r.resolveActiveIndex(),e=o??-1;switch(t.focus){case 0:{for(let a=0;a<l.length;++a)if(!r.resolveDisabled(l[a],a,l))return a;return o}case 1:{e===-1&&(e=l.length);for(let a=e-1;a>=0;--a)if(!r.resolveDisabled(l[a],a,l))return a;return o}case 2:{for(let a=e+1;a<l.length;++a)if(!r.resolveDisabled(l[a],a,l))return a;return o}case 3:{for(let a=l.length-1;a>=0;--a)if(!r.resolveDisabled(l[a],a,l))return a;return o}case 4:{for(let a=0;a<l.length;++a)if(r.resolveId(l[a],a,l)===t.id)return a;return o}case 5:return null;default:ee(t)}}let $=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function A(t){var r,l;let o=(r=t.innerText)!=null?r:"",e=t.cloneNode(!0);if(!(e instanceof HTMLElement))return o;let a=!1;for(let p of e.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))p.remove(),a=!0;let i=a?(l=e.innerText)!=null?l:"":o;return $.test(i)&&(i=i.replace($,"")),i}function ae(t){let r=t.getAttribute("aria-label");if(typeof r=="string")return r.trim();let l=t.getAttribute("aria-labelledby");if(l){let o=l.split(" ").map(e=>{let a=document.getElementById(e);if(a){let i=a.getAttribute("aria-label");return typeof i=="string"?i.trim():A(a).trim()}return null}).filter(Boolean);if(o.length>0)return o.join(", ")}return A(t).trim()}function ne(t){let r=S(""),l=S("");return()=>{let o=g(t);if(!o)return"";let e=o.innerText;if(r.value===e)return l.value;let a=ae(o).trim().toLowerCase();return r.value=e,l.value=a,a}}var le=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(le||{}),re=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(re||{});function ue(t){requestAnimationFrame(()=>requestAnimationFrame(t))}let C=Symbol("MenuContext");function w(t){let r=H(C,null);if(r===null){let l=new Error(`<${t} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(l,w),l}return r}let fe=P({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(t,{slots:r,attrs:l}){let o=S(1),e=S(null),a=S(null),i=S([]),p=S(""),f=S(null),c=S(1);function n(s=v=>v){let v=f.value!==null?i.value[f.value]:null,d=Q(s(i.value.slice()),I=>g(I.dataRef.domRef)),u=v?d.indexOf(v):null;return u===-1&&(u=null),{items:d,activeItemIndex:u}}let b={menuState:o,buttonRef:e,itemsRef:a,items:i,searchQuery:p,activeItemIndex:f,activationTrigger:c,closeMenu:()=>{o.value=1,f.value=null},openMenu:()=>o.value=0,goToItem(s,v,d){let u=n(),I=te(s===h.Specific?{focus:h.Specific,id:v}:{focus:s},{resolveItems:()=>u.items,resolveActiveIndex:()=>u.activeItemIndex,resolveId:y=>y.id,resolveDisabled:y=>y.dataRef.disabled});p.value="",f.value=I,c.value=d??1,i.value=u.items},search(s){let v=p.value!==""?0:1;p.value+=s.toLowerCase();let d=(f.value!==null?i.value.slice(f.value+v).concat(i.value.slice(0,f.value+v)):i.value).find(I=>I.dataRef.textValue.startsWith(p.value)&&!I.dataRef.disabled),u=d?i.value.indexOf(d):-1;u===-1||u===f.value||(f.value=u,c.value=1)},clearSearch(){p.value=""},registerItem(s,v){let d=n(u=>[...u,{id:s,dataRef:v}]);i.value=d.items,f.value=d.activeItemIndex,c.value=1},unregisterItem(s){let v=n(d=>{let u=d.findIndex(I=>I.id===s);return u!==-1&&d.splice(u,1),d});i.value=v.items,f.value=v.activeItemIndex,c.value=1}};return j([e,a],(s,v)=>{var d;b.closeMenu(),W(v,J.Loose)||(s.preventDefault(),(d=g(e))==null||d.focus())},M(()=>o.value===0)),U(C,b),z(M(()=>B(o.value,{0:D.Open,1:D.Closed}))),()=>{let s={open:o.value===0,close:b.closeMenu};return R({ourProps:{},theirProps:t,slot:s,slots:r,attrs:l,name:"Menu"})}}}),pe=P({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:()=>`headlessui-menu-button-${T()}`}},setup(t,{attrs:r,slots:l,expose:o}){let e=w("MenuButton");o({el:e.buttonRef,$el:e.buttonRef});function a(c){switch(c.key){case m.Space:case m.Enter:case m.ArrowDown:c.preventDefault(),c.stopPropagation(),e.openMenu(),x(()=>{var n;(n=g(e.itemsRef))==null||n.focus({preventScroll:!0}),e.goToItem(h.First)});break;case m.ArrowUp:c.preventDefault(),c.stopPropagation(),e.openMenu(),x(()=>{var n;(n=g(e.itemsRef))==null||n.focus({preventScroll:!0}),e.goToItem(h.Last)});break}}function i(c){switch(c.key){case m.Space:c.preventDefault();break}}function p(c){t.disabled||(e.menuState.value===0?(e.closeMenu(),x(()=>{var n;return(n=g(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})})):(c.preventDefault(),e.openMenu(),ue(()=>{var n;return(n=g(e.itemsRef))==null?void 0:n.focus({preventScroll:!0})})))}let f=K(M(()=>({as:t.as,type:r.type})),e.buttonRef);return()=>{var c;let n={open:e.menuState.value===0},{id:b,...s}=t,v={ref:e.buttonRef,id:b,type:f.value,"aria-haspopup":"menu","aria-controls":(c=g(e.itemsRef))==null?void 0:c.id,"aria-expanded":e.menuState.value===0,onKeydown:a,onKeyup:i,onClick:p};return R({ourProps:v,theirProps:s,slot:n,attrs:r,slots:l,name:"MenuButton"})}}}),me=P({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-menu-items-${T()}`}},setup(t,{attrs:r,slots:l,expose:o}){let e=w("MenuItems"),a=S(null);o({el:e.itemsRef,$el:e.itemsRef}),G({container:M(()=>g(e.itemsRef)),enabled:M(()=>e.menuState.value===0),accept(n){return n.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:n.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(n){n.setAttribute("role","none")}});function i(n){var b;switch(a.value&&clearTimeout(a.value),n.key){case m.Space:if(e.searchQuery.value!=="")return n.preventDefault(),n.stopPropagation(),e.search(n.key);case m.Enter:if(n.preventDefault(),n.stopPropagation(),e.activeItemIndex.value!==null){let s=e.items.value[e.activeItemIndex.value];(b=g(s.dataRef.domRef))==null||b.click()}e.closeMenu(),O(g(e.buttonRef));break;case m.ArrowDown:return n.preventDefault(),n.stopPropagation(),e.goToItem(h.Next);case m.ArrowUp:return n.preventDefault(),n.stopPropagation(),e.goToItem(h.Previous);case m.Home:case m.PageUp:return n.preventDefault(),n.stopPropagation(),e.goToItem(h.First);case m.End:case m.PageDown:return n.preventDefault(),n.stopPropagation(),e.goToItem(h.Last);case m.Escape:n.preventDefault(),n.stopPropagation(),e.closeMenu(),x(()=>{var s;return(s=g(e.buttonRef))==null?void 0:s.focus({preventScroll:!0})});break;case m.Tab:n.preventDefault(),n.stopPropagation(),e.closeMenu(),x(()=>Y(g(e.buttonRef),n.shiftKey?k.Previous:k.Next));break;default:n.key.length===1&&(e.search(n.key),a.value=setTimeout(()=>e.clearSearch(),350));break}}function p(n){switch(n.key){case m.Space:n.preventDefault();break}}let f=X(),c=M(()=>f!==null?(f.value&D.Open)===D.Open:e.menuState.value===0);return()=>{var n,b;let s={open:e.menuState.value===0},{id:v,...d}=t,u={"aria-activedescendant":e.activeItemIndex.value===null||(n=e.items.value[e.activeItemIndex.value])==null?void 0:n.id,"aria-labelledby":(b=g(e.buttonRef))==null?void 0:b.id,id:v,onKeydown:i,onKeyup:p,role:"menu",tabIndex:0,ref:e.itemsRef};return R({ourProps:u,theirProps:d,slot:s,attrs:r,slots:l,features:F.RenderStrategy|F.Static,visible:c.value,name:"MenuItems"})}}}),ge=P({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:()=>`headlessui-menu-item-${T()}`}},setup(t,{slots:r,attrs:l,expose:o}){let e=w("MenuItem"),a=S(null);o({el:a,$el:a});let i=M(()=>e.activeItemIndex.value!==null?e.items.value[e.activeItemIndex.value].id===t.id:!1),p=ne(a),f=M(()=>({disabled:t.disabled,get textValue(){return p()},domRef:a}));_(()=>e.registerItem(t.id,f)),q(()=>e.unregisterItem(t.id)),N(()=>{e.menuState.value===0&&i.value&&e.activationTrigger.value!==0&&x(()=>{var u,I;return(I=(u=g(a))==null?void 0:u.scrollIntoView)==null?void 0:I.call(u,{block:"nearest"})})});function c(u){if(t.disabled)return u.preventDefault();e.closeMenu(),O(g(e.buttonRef))}function n(){if(t.disabled)return e.goToItem(h.Nothing);e.goToItem(h.Specific,t.id)}let b=Z();function s(u){b.update(u)}function v(u){b.wasMoved(u)&&(t.disabled||i.value||e.goToItem(h.Specific,t.id,0))}function d(u){b.wasMoved(u)&&(t.disabled||i.value&&e.goToItem(h.Nothing))}return()=>{let{disabled:u}=t,I={active:i.value,disabled:u,close:e.closeMenu},{id:y,...L}=t;return R({ourProps:{id:y,ref:a,role:"menuitem",tabIndex:u===!0?void 0:-1,"aria-disabled":u===!0?!0:void 0,disabled:void 0,onClick:c,onFocus:n,onPointerenter:s,onMouseenter:s,onPointermove:v,onMousemove:v,onPointerleave:d,onMouseleave:d},theirProps:{...l,...L},slot:I,attrs:l,slots:r,name:"MenuItem"})}}});export{fe as I,me as S,ge as b,h as c,te as f,pe as g,G as i,ne as p,Z as u};
